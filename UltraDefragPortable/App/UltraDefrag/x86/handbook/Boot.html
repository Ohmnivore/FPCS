<!-- HTML header for doxygen 1.8.3-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<meta name="keywords" content="UltraDefrag, Ultra Defragmenter, defragmentation, Open Source disk defragmenter, defragger, boot time defragmentation, boot time defragger, handbook, user manual, index, table of contents, TOC" />
<title>UltraDefrag Handbook: Boot Time Defragmentation - 6.0.2</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="custom_doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0" style="width: 100%; height: 100%">
 <tbody>
 <tr>
  <td id="projectlogo"><a href="http://ultradefrag.sourceforge.net/"><img alt="ultradefrag homepage" src="udefrag80x15-colored-light.gif"/></a></td>
  <td id="sourceforgelogo"><a href="http://sourceforge.net/p/ultradefrag"><img alt="ultradefrag project" src="sflogo.gif"/></a></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname"><a href="index.html" class="index_pointer">UltraDefrag Handbook</a>
   &#160;<span id="projectnumber">6.0.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('Boot.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Boot Time Defragmentation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>UltraDefrag also includes a new mode that allows you to run it at boot time in a manner similar to chkdsk. This is known as a native application. The primary goal of it is defragmentation of locked files. UltraDefrag runs at Windows boot before any file locking, so it can defragment almost everything, including page and hibernation files. <a href="http://ultradefrag.sourceforge.net/screenshots.html">View screenshots...</a></p>
<p>If the boot time defragmenter is enabled, it will run at every boot. </p>
<dl class="section note"><dt>Note</dt><dd>You will have a chance to exit immediately, just press any key when the appropriate prompt is displayed. If no key is pressed during this delay, the boot time script will be executed.</dd></dl>
<p>You can always stop the disk analysis/defragmentation by pressing the Pause/Break key on the keyboard.</p>
<p>The following restrictions exist for the boot time scans:</p>
<ul>
<li>You may not scan encrypted disks. This is because lsass.exe, the component of the operating system that reads encrypted disks, is still not loaded at a time of the native applications execution.</li>
<li>In Windows Safe Mode the program cannot display text on the boot screen. UltraDefrag checks for boot options and returns immediately, if the Safe Mode flag has been found.</li>
</ul>
<p>The boot time defragmenter can be enabled/disabled either from the main GUI window or by typing boot-on/boot-off commands in the command prompt.</p>
<h1>Boot Time Modes</h1>
<p>The boot time defragmenter can be executed in two modes: </p>
<dl class="section user"><dt>Boot time script</dt><dd>The boot time script consists of the disk defragmentation commands, ancillary commands and comments. It is located at <b>%windir%\system32\ud-boot-time.cmd</b>. To edit this file execute boot-config at the command prompt or simply click the Boot time script button on the UltraDefrag GUI toolbar. <br/>
<br/>
 The boot time script simplifies also the use of UltraDefrag on computers running Windows 98. After installing Windows XP as a second operating system, UltraDefrag may be installed too. After adding the shutdown command to the boot time script you may simply boot the XP system (which requires much less resources at boot time!) and safely leave your computer. It will be shut down automatically after the job is completed. <br/>
<br/>
 To abort the script execution and enter the interactive mode immediately hit <b>ESC</b> at any time during the boot time script processing.</dd></dl>
<dl class="section user"><dt>Interactive mode</dt><dd>When the exit command is missing in the boot time script UltraDefrag runs in interactive mode after the last script command is executed. UltraDefrag displays the following command prompt and waits for the users input: <br/>
 <pre class="fragment">Interactive mode:
Type 'help' for list of supported commands.

#
</pre> <br/>
 All commands displaying long lists (help, hexview, history, man, set, type) are splitting them into pages in interactive mode.</dd></dl>
<h1>Available Boot Time Commands</h1>
<dl class="section user"><dt>; or #</dt><dd>Lines starting with one of these characters are treated as comments.</dd></dl>
<dl class="section user"><dt>@</dt><dd>Do not show the command line preceded by the at-sign on the screen. By default the command line is displayed on the screen.</dd></dl>
<dl class="section user"><dt>boot-on</dt><dd>Turn on the boot time defragmentation to be executed at every boot.</dd></dl>
<dl class="section user"><dt>boot-off</dt><dd>Turn off the boot time defragmentation. It prevents them from being executed at next reboots. Until you will enable them manually through UltraDefrag Configuration dialog or boot-on.cmd script.</dd></dl>
<dl class="section user"><dt>call</dt><dd>Similar to the DOS command. Executes the specified script. If no script is specified, the default boot time script is executed.</dd></dl>
<dl class="section user"><dt>echo</dt><dd>Similar to the DOS command. Display a message, empty line, enable/disable showing the command line on the screen or display the status of showing the command line.</dd></dl>
<dl class="section user"><dt>exit</dt><dd>Similar to the DOS command. Break the boot time program execution and return the specified error code or zero.</dd></dl>
<dl class="section user"><dt>help</dt><dd>Show a list of all available commands.</dd></dl>
<dl class="section user"><dt>hexview</dt><dd>Display the contents of the specified file in a HEX viewer layout. <br/>
 <pre class="fragment">000000C0: 0a 00 3b 00 20 00 46 00 |   ;   F
000000C8: 72 00 61 00 67 00 6d 00 | r a g m
000000D0: 65 00 6e 00 74 00 65 00 | e n t e
</pre></dd></dl>
<dl class="section user"><dt>history</dt><dd>Show a list of all manually entered commands. To cycle through the commands use the up/down arrow/cursor keys.</dd></dl>
<dl class="section user"><dt>man</dt><dd>List or display available manual pages.</dd></dl>
<dl class="section user"><dt>pause</dt><dd>Pause the script execution for the specified time interval (in milliseconds, 2147483647 maximum) or till a key is pressed, if no duration is specified. For example, the command <b>pause 1000</b> will pause execution for one second.</dd></dl>
<dl class="section user"><dt>reboot</dt><dd>Reboot the computer.</dd></dl>
<dl class="section user"><dt>set</dt><dd>Similar to the DOS command. List, set and clear environment variables. For further information about the supported variables consult the <a class="el" href="Console.html">Console Interface</a> page.</dd></dl>
<dl class="section user"><dt>shutdown</dt><dd>Halt the computer.</dd></dl>
<dl class="section user"><dt>type</dt><dd>Similar to the DOS command. Display the contents of a file, the default is the boot time script.</dd></dl>
<dl class="section user"><dt>udefrag</dt><dd>This is the native equivalent of the UltraDefrag command line tool. The following command switches are supported:<br/>
<br/>
 <b>-l, -la, -a, -o, -q, --quick-optimize, --optimize-mft, --all, --all-fixed, -r, --repeat</b><br/>
<br/>
 Multiple drive letters on a single command line are allowed.<br/>
 You can specify <b>absolute paths</b> to process single files or directories. Paths including spaces must be enclosed by double quotes ("). To specify multiple paths separate them by spaces.<br/>
<br/>
 Example: <div class="fragment"><div class="line">udefrag <span class="stringliteral">&quot;C:\Documents and Settings&quot;</span> C:\WINDOWS\WindowsUpdate.log</div>
</div><!-- fragment --> <br/>
 For further information about the command switches and variables consult the <a class="el" href="Console.html">Console Interface</a> page.</dd></dl>
<p>When UltraDefrag encounters the wrong syntax it shows an appropriate message on the screen and continues the script execution.</p>
<h1>Environment variable expansion</h1>
<p>The boot time script and the interactive mode support environment variable expansion. This allows a more flexible script to be written by using <b>%SystemDrive%</b> instead of <b>C:</b>. In addition to the regular variables there are two variables, <b>DATE</b> and <b>TIME</b>, that will be set dynamically. Both are formated to be easily used as part of a file name, so a timestamped log file name can be created.</p>
<dl class="section user"><dt>DATE</dt><dd>This will be expanded to the current date in the format <b>YYYY-MM-DD</b> <div class="fragment"><div class="line">echo DATE ... %DATE%</div>
</div><!-- fragment --> Results in the display of: <pre class="fragment">DATE ... 2012-02-14
</pre></dd></dl>
<dl class="section user"><dt>TIME</dt><dd>This will be expanded to the current time in the format <b>HH-MM</b> <div class="fragment"><div class="line">echo TIME ... %TIME%</div>
</div><!-- fragment --> Results in the display of: <pre class="fragment">TIME ... 12-04
</pre></dd></dl>
<h1>Boot time script example</h1>
<p>The following script is used by default: </p>
<div class="fragment"><div class="line">@echo off</div>
<div class="line">;--------------------------------------------------------------------</div>
<div class="line">;                UltraDefrag Boot Time Shell Script</div>
<div class="line">;--------------------------------------------------------------------</div>
<div class="line">; !!! NOTE: THIS FILE MUST BE SAVED IN UNICODE (UTF-16) ENCODING !!!</div>
<div class="line">;--------------------------------------------------------------------</div>
<div class="line"></div>
<div class="line">set UD_IN_FILTER=*windows*;*winnt*;*ntuser*;*pagefile.sys;*hiberfil.sys</div>
<div class="line">set UD_EX_FILTER=*temp*;*tmp*;*.zip;*.7z;*.rar;*dllcache*;*ServicePackFiles*</div>
<div class="line"></div>
<div class="line">; uncomment the following line to create debugging output</div>
<div class="line">; set UD_DBGPRINT_LEVEL=DETAILED</div>
<div class="line"></div>
<div class="line">; uncomment the following line to save debugging information to a log file</div>
<div class="line">; set UD_LOG_FILE_PATH=%UD_INSTALL_DIR%\Logs\defrag_native.log</div>
<div class="line"></div>
<div class="line">udefrag c:</div>
<div class="line"></div>
<div class="line">exit</div>
</div><!-- fragment --><p>The following script utilizes environment variable expansion: </p>
<div class="fragment"><div class="line">;--------------------------------------------------------------------</div>
<div class="line">;                UltraDefrag Boot Time Shell Script</div>
<div class="line">;--------------------------------------------------------------------</div>
<div class="line">; !!! NOTE: THIS FILE MUST BE SAVED IN UNICODE (UTF-16) ENCODING !!!</div>
<div class="line">;--------------------------------------------------------------------</div>
<div class="line"></div>
<div class="line">set UD_IN_FILTER=*windows*;*winnt*;*ntuser*;*pagefile.sys;*hiberfil.sys</div>
<div class="line">set UD_EX_FILTER=*temp*;*tmp*;*.zip;*.7z;*.rar;*dllcache*;*ServicePackFiles*</div>
<div class="line"></div>
<div class="line">;create a timestamped log file</div>
<div class="line">set UD_LOG_FILE_PATH=%UD_INSTALL_DIR%\Logs\defrag_native_%DATE%_%TIME%.log</div>
<div class="line"></div>
<div class="line">udefrag %SystemDrive%</div>
<div class="line"></div>
<div class="line">exit</div>
</div><!-- fragment --> 
   <HR>
    <TABLE STYLE="border: none; width: 97%; margin:auto;">
      <TR>
        <TD STYLE="text-align: left; width: 50%;">Previous: <a href="GUI.html">Graphical Interface</a></TD>
        <TD STYLE="text-align: right; width: 50%;">Next: <a href="Reports.html">File Fragmentation Reports</a></TD>
      </TR>
    </TABLE>
    </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <b>doxygen</b></a> 1.8.3.1 </li>
  </ul>
</div>
</body>
</html>
